/*! module-utils 2014-05-07 */
(function(){function b(f,e){if(e.self){d(e.self,f,true)}if(e.prototype){d(e.prototype,f.prototype,true)}if(e.included){e.included(f)}}function d(i,e,h){var f,g;for(f in i){if(i.hasOwnProperty(f)&&(!h||e[f]===g)){e[f]=i[f]}}i=e=null}var c={setup:function a(e){if(c.ApplicationEvents){b(e,c.ApplicationEvents);if(c.Notifications){b(e,c.Notifications)}}}};window.Beacon=c})();Beacon=(function(h){function b(){this._subscribers={}}b.prototype={_subscribers:null,constructor:b,destructor:function c(){if(!this._subscribers){return}var n=this._subscribers,l,k,j,m;for(k in n){if(n.hasOwnProperty(k)){for(j=0,m=n[k].length;j<m;j++){l=n[k][j];l.callback=l.context=null}n[k]=null}}l=n=this._subscribers=null},_dispatchEvent:function g(n,o,p){var l,j,k=0,m=p.length;for(k;k<m;k++){l=p[k];if(l.type==="function"){j=l.callback.call(l.context,n,o)}else{if(l.type==="string"){j=l.context[l.callback](n,o)}}if(j===false){break}}p=l=n=o=null;return j!==false},publish:function e(j,k,l){if(!this._subscribers[j]){return true}var i=this._dispatchEvent(k,l,this._subscribers[j]);k=l=null;return i},subscribe:function a(k,j,m){var i=typeof j;var l=typeof m;this._subscribers[k]=this._subscribers[k]||[];if(i==="function"){this._subscribers[k].push({context:null,callback:j,type:"function"})}else{if(i==="object"){if(l==="string"&&typeof j[m]!=="function"){throw new Error("Cannot subscribe to "+k+" because "+m+" is not a function")}this._subscribers[k].push({context:j||null,callback:m,type:l})}}},unsubscribe:function f(m,l,q){if(this._subscribers[m]){var j=typeof l,p=typeof q,o=this._subscribers[m],k=o.length,n;if(j==="function"){q=l;l=null;p="function"}else{if(j==="object"&&p==="undefined"){p="any"}}while(k--){n=o[k];if((p==="any"&&n.context===l)||(n.type===p&&n.context===l&&n.callback===q)){o.splice(k,1)}}o=n=null}l=q=null},unsubscribeAll:function d(k){var l,j,m;for(l in this._subscribers){if(this._subscribers.hasOwnProperty(l)){m=this._subscribers[l];j=m.length;while(j--){if(m[j].context===k){m.splice(j,1)}}}}k=m=null}};h.Dispatcher=b;return h})(window.Beacon||{});Beacon=(function(f){var h={eventDispatcher:null,self:{getEventDispatcher:function b(){if(!f.ApplicationEvents.eventDispatcher){f.ApplicationEvents.eventDispatcher=new f.Dispatcher()}return f.ApplicationEvents.eventDispatcher},publish:function d(i,j,k){return this.getEventDispatcher().publish(i,j,k)},subscribe:function a(i,j,k){this.getEventDispatcher().subscribe(i,j,k)},unsubscribe:function e(i,j,k){this.getEventDispatcher().unsubscribe(i,j,k)}},prototype:{eventDispatcher:null,_initApplicationEvents:function g(){if(!this.hasOwnProperty("eventDispatcher")){this.eventDispatcher=this.constructor.getEventDispatcher()}},_destroyApplicationEvents:function c(){if(this.eventDispatcher){this.eventDispatcher.unsubscribe(this)}},publish:function d(i,j){return this.eventDispatcher.publish(i,this,j)},subscribe:function a(i,j,k){this.eventDispatcher.subscribe(i,j,k);return this},unsubscribe:function e(i,j,k){this.eventDispatcher.unsubscribe(i,j,k);return this}}};f.ApplicationEvents=h;return f})(window.Beacon||{});Beacon=(function(a){var g=0;var h={self:{addNotifications:function b(n){var m,l=this.prototype.notifications||{};for(m in n){if(n.hasOwnProperty(m)){if(l[m]){l[m]=(l[m] instanceof Array)?l[m]:[l[m]]}else{l[m]=[]}l[m].push(n[m])}}this.prototype.notifications=l;l=n=null}},prototype:{_notificationDispatcher:null,_notificationId:null,_notificationIdPrefix:"notifications",notifications:null,_initNotifications:function d(){if(!this.__proto__.hasOwnProperty("_compiledNotifications")){this._compileNotifications()}this._initApplicationEvents();this._notificationId=g++;var m,n,o,l;for(m in this._compiledNotifications){if(this._compiledNotifications.hasOwnProperty(m)){l=this._compiledNotifications[m];for(n=0,o=l.length;n<o;n++){this.listen(m,this,l[n])}}}this._setUpNotifications()},_compileNotifications:function k(){var q={},m,n,p,l,o=this.__proto__;while(o){if(o.hasOwnProperty("notifications")&&o.notifications){l=o.notifications;for(m in l){if(l.hasOwnProperty(m)){q[m]=q[m]||[];l[m]=l[m] instanceof Array?l[m]:[l[m]];n=l[m].length;while(n--){q[m].unshift(l[m][n])}}}}o=o.__proto__}this.__proto__._compiledNotifications=q;o=l=q=null},_destroyNotifications:function f(){if(this._notificationDispatcher){this._notificationDispatcher.destructor();this._notificationDispatcher=null}},_setUpNotifications:function c(){},notify:function j(l,m){var n=this.publish(this._notificationIdPrefix+"."+this._notificationId+"."+l,m);m=null;return n},listen:function e(m,l,n){this.subscribe(this._notificationIdPrefix+"."+this._notificationId+"."+m,l,n);l=n=null;return this},ignore:function i(m,l,n){this.unsubscribe(this._notificationIdPrefix+"."+this._notificationId+"."+m,l,n);l=n=null;return this}}};a.Notifications=h;return a})(window.Beacon||{});Module.Utils.Events={included:function(a){Beacon.setup(a);a.addCallback("beforeReady","_initApplicationEvents");if(Beacon.Notifications){a.addCallback("beforeReady","_initNotifications")}}};Module.Utils.include(Module.Utils.Events);